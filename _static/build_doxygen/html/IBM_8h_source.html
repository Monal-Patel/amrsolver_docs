<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AMR solver: /media/monal/main/code/amrsolver1/src/ibm/IBM.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMR solver
   &#160;<span id="projectnumber">v0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0526fc02dd5ee4981cd2ea727eb751a0.html">ibm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IBM.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="IBM_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef IBM_H_</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define IBM_H_</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="IBM_8h.html#aa3bb3b5f8fcd8b028b753db498e5c2ef">    4</a></span>&#160;<span class="preprocessor">#define NIMPS 2 </span><span class="comment">// number of image points per ghost point</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;AMReX_Amr.H&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;AMReX_AmrLevel.H&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;AMReX_FabArray.H&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;AMReX_IntVect.H&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;AMReX_Derive.H&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;AMReX_StateDescriptor.H&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;AMReX_GpuContainers.H&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// #include &lt;CNS_index_macros.H&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cns_prob.H&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// basic CGAL headers</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;CGAL/Polyhedron_3.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;CGAL/Polygon_mesh_processing/IO/polygon_mesh_io.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// CGAL headers for AABB tree for closest point</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;CGAL/Simple_cartesian.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;CGAL/AABB_tree.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;CGAL/AABB_traits.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;CGAL/AABB_face_graph_triangle_primitive.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// CGAL headers for AABB tree for surface data</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;CGAL/Polygon_mesh_processing/compute_normal.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// #include &lt;CGAL/Unique_hash_map.h&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// #include &lt;boost/unordered_map.hpp&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;boost/property_map/property_map.hpp&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span>amrex;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="namespaceIBM.html">   37</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceIBM.html">IBM</a> {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// CGAL types -------------------------------------------</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a5c173780993440fb7c53b55b9d617904">   40</a></span>&#160;  <span class="keyword">typedef</span> CGAL::Simple_cartesian&lt;Real&gt; <a class="code" href="namespaceIBM.html#a5c173780993440fb7c53b55b9d617904">K2</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespaceIBM.html#ab004ecad26abd07304721f93b53c96d9">   41</a></span>&#160;  <span class="keyword">typedef</span> K2::Point_3 <a class="code" href="namespaceIBM.html#ab004ecad26abd07304721f93b53c96d9">Point</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespaceIBM.html#aef0e4eb6d237070846f13a40d2e90063">   42</a></span>&#160;  <span class="keyword">typedef</span> CGAL::Polyhedron_3&lt;K2&gt; <a class="code" href="namespaceIBM.html#aef0e4eb6d237070846f13a40d2e90063">Polyhedron</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a2ddefb5d5000c4bfda7bea2d34f5e6c3">   44</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespaceIBM.html#a2ddefb5d5000c4bfda7bea2d34f5e6c3">K2::FT</a> <a class="code" href="namespaceIBM.html#a2ddefb5d5000c4bfda7bea2d34f5e6c3">FT</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a3bc0f9fb0e76244cb684d35d4cf0ac83">   45</a></span>&#160;  <span class="keyword">typedef</span> K2::Segment_3 <a class="code" href="namespaceIBM.html#a3bc0f9fb0e76244cb684d35d4cf0ac83">Segment</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespaceIBM.html#af12ba22129ce6cc0a035cbc8c914cab5">   46</a></span>&#160;  <span class="keyword">typedef</span> CGAL::AABB_face_graph_triangle_primitive&lt;Polyhedron&gt; <a class="code" href="namespaceIBM.html#af12ba22129ce6cc0a035cbc8c914cab5">Primitive</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a26dbd197d9ba9813a5c7aeb26f2282da">   47</a></span>&#160;  <span class="keyword">typedef</span> CGAL::AABB_traits&lt;K2, Primitive&gt; <a class="code" href="namespaceIBM.html#a26dbd197d9ba9813a5c7aeb26f2282da">Traits</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="namespaceIBM.html#ad9f4d764f206d71381e965523b58ace3">   48</a></span>&#160;  <span class="keyword">typedef</span> CGAL::AABB_tree&lt;Traits&gt; <a class="code" href="namespaceIBM.html#ad9f4d764f206d71381e965523b58ace3">Tree</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a7ae8422f8b42c8d6e43ac05822de0904">   49</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespaceIBM.html#a7ae8422f8b42c8d6e43ac05822de0904">Tree::Point_and_primitive_id</a> <a class="code" href="namespaceIBM.html#a7ae8422f8b42c8d6e43ac05822de0904">Point_and_primitive_id</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a3ed74778d4b5bb4688ad8aa65f024af3">   51</a></span>&#160;  <span class="keyword">typedef</span> K2::Vector_3 <a class="code" href="namespaceIBM.html#a3ed74778d4b5bb4688ad8aa65f024af3">Vector_CGAL</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="namespaceIBM.html#ad80af28e30018458d4c4c1efc0ba02d7">   52</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespaceIBM.html#ad80af28e30018458d4c4c1efc0ba02d7">boost::graph_traits&lt;Polyhedron&gt;::face_descriptor</a>  <a class="code" href="namespaceIBM.html#ad80af28e30018458d4c4c1efc0ba02d7">face_descriptor</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// typedef Polyhedron::Vertex_iterator      vertexIter;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// typedef Polyhedron::Face_iterator        faceIter;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// CGAL types -------------------------------------------</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// surfdata holds the relevant surface data for each element.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structIBM_1_1surfdata.html">   59</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structIBM_1_1surfdata.html">surfdata</a> {</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structIBM_1_1surfdata.html#ac4ac26a2b3d8821c8df693980fd2bd74">   60</a></span>&#160;    Array&lt;Real,NPRIM&gt; state={0.0};</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structIBM_1_1surfdata.html#ade6d2b64038df080a6726fde49a541f9">   61</a></span>&#160;    Array&lt;Real,AMREX_SPACEDIM&gt; displace = {0.0};</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  };</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// GP holds the relevant data for each ghost point.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">// struct gp {</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">//     // attributes</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">//     Array&lt;int , AMREX_SPACEDIM&gt; idx={0};</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">//     Point_and_primitive_id closest; // closest surface point (ib point) and face</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//     Real disGP; </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//     Vector&lt;Array&lt;Real,AMREX_SPACEDIM&gt;&gt; imps; </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">//     Vector&lt;Array&lt;int,AMREX_SPACEDIM&gt;&gt; impscell; </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">//     Vector&lt;Array&lt;Real,8&gt;&gt; ipweights; </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//     // for imp1 [(i,j,k), (i+1,j,k), (i,j+1,k), (i,j,k+1),</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//     //  ... ]</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// };</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html">   78</a></span>&#160;  <span class="keyword">struct </span><a class="code" href="structIBM_1_1gpData__t.html">gpData_t</a> {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#a2dcf566c5d9c84b871125e70fade28aa">   80</a></span>&#160;      <a class="code" href="structIBM_1_1gpData__t.html#a2dcf566c5d9c84b871125e70fade28aa">gpData_t</a>() {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// index cube for image point interpolation</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{0,0,0});</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{0,1,0});</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{1,1,0});</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{1,0,0});</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{0,0,1});</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{0,1,1});</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{1,1,1});</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        indexCube.push_back(Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;{1,0,1});</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="comment">// CPU only attributes</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#a4ffba4d4b82e351308a38c852053a415">   93</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="structIBM_1_1gpData__t.html#a4ffba4d4b82e351308a38c852053a415">ngps</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#af34569ede451cac3d84ddb1e1ca0584b">   94</a></span>&#160;      Vector&lt;Point_and_primitive_id&gt; <a class="code" href="structIBM_1_1gpData__t.html#af34569ede451cac3d84ddb1e1ca0584b">closest_cgal</a>; <span class="comment">// closest surface point (ib point) and face</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">// GPU/CPU attributes</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#ac2a1f182ea611fd539d30b0e37d49707">   97</a></span>&#160;      Gpu::ManagedVector&lt;Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;&gt; <a class="code" href="structIBM_1_1gpData__t.html#ac2a1f182ea611fd539d30b0e37d49707">gp_ijk</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#a36cfbf4d4bd1c2369be07646b49cf80a">   98</a></span>&#160;      Gpu::ManagedVector&lt;Array1D&lt;Real,0,AMREX_SPACEDIM-1&gt;&gt; normal,tangent1,tangent2, <a class="code" href="structIBM_1_1gpData__t.html#a36cfbf4d4bd1c2369be07646b49cf80a">ib_xyz</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#ab130b8cdca7247fb7c9e7710f61d6973">   99</a></span>&#160;      Gpu::ManagedVector&lt;Real&gt; <a class="code" href="structIBM_1_1gpData__t.html#ab130b8cdca7247fb7c9e7710f61d6973">disGP</a>,disIM; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#a91e734453ba5a00bdc5d7ee769175bbb">  101</a></span>&#160;      Gpu::ManagedVector&lt;Array2D&lt;Real,0,<a class="code" href="IBM_8h.html#aa3bb3b5f8fcd8b028b753db498e5c2ef">NIMPS</a>-1,0,AMREX_SPACEDIM-1&gt;&gt; <a class="code" href="structIBM_1_1gpData__t.html#a91e734453ba5a00bdc5d7ee769175bbb">imp_xyz</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#a47dd83fc0c0bbfa7b887cbfda464d6a1">  102</a></span>&#160;      Gpu::ManagedVector&lt;Array2D&lt;int, 0,<a class="code" href="IBM_8h.html#aa3bb3b5f8fcd8b028b753db498e5c2ef">NIMPS</a>-1,0,AMREX_SPACEDIM-1&gt;&gt; <a class="code" href="structIBM_1_1gpData__t.html#a47dd83fc0c0bbfa7b887cbfda464d6a1">imp_ijk</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#afb4b7e71c94d2642ffeed1dfc726c735">  103</a></span>&#160;      Gpu::ManagedVector&lt;Array2D&lt;Real,0,<a class="code" href="IBM_8h.html#aa3bb3b5f8fcd8b028b753db498e5c2ef">NIMPS</a>-1,0,7&gt;&gt; <a class="code" href="structIBM_1_1gpData__t.html#afb4b7e71c94d2642ffeed1dfc726c735">imp_ipweights</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="comment">// for imp1 [(i,j,k), (i+1,j,k), (i,j+1,k), (i,j,k+1),</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="comment">//  ... ]</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">// Anti-clockwise order k=0 plane first, then k=1 plane.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#adef7a3cd3e3d61fad726f8ab600a814f">  108</a></span>&#160;      Gpu::ManagedVector&lt;Array1D&lt;int,0,AMREX_SPACEDIM-1&gt;&gt; <a class="code" href="structIBM_1_1gpData__t.html#adef7a3cd3e3d61fad726f8ab600a814f">indexCube</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">// = { {0,0,0}, {0,1,0}, {1,1,0}, {1,0,0}, {0,0,1}, {0,1,1}, {1,1,1}, {1,0,1}}; // index cube for image point interpolation</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structIBM_1_1gpData__t.html#a60be254d2dd72f7720c8d80683e456c4">  111</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="structIBM_1_1gpData__t.html#a60be254d2dd72f7720c8d80683e456c4">resize</a> (<span class="keywordtype">int</span> n) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        gp_ijk.resize(n); ib_xyz.resize(n);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        disGP.resize(n); disIM.resize(n); </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        imp_xyz.resize(n); imp_ijk.resize(n); imp_ipweights.resize(n);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  };</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// IBFab holds the solid point and ghost point boolean arrays</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classIBM_1_1IBFab.html">  119</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classIBM_1_1IBFab.html">IBFab</a>: <span class="keyword">public</span> BaseFab&lt;bool&gt; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="comment">// attributes //</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// Vector&lt;gp&gt; gpArray; // problem with this approach is that Vector type is not available on the GPUs.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classIBM_1_1IBFab.html#a7b39d2c2c612847501a75b9b39e8a0b8">  125</a></span>&#160;      <a class="code" href="structIBM_1_1gpData__t.html">gpData_t</a> <a class="code" href="classIBM_1_1IBFab.html#a7b39d2c2c612847501a75b9b39e8a0b8">gpData</a>; <span class="comment">// a single structure which holds GP data in vectors which can be resized on CPU or GPU.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// AsyncArray&lt;gp&gt;* gpArrayAsync(1); // designed to be used for temporary transfers, in routines, not for storage.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="comment">// int ngps = 0;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// constructors and destructors //</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">// using Box</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keyword">explicit</span> <a class="code" href="classIBM_1_1IBFab.html">IBFab</a> (<span class="keyword">const</span> Box&amp; b, <span class="keywordtype">int</span> ncomp, <span class="keywordtype">bool</span> alloc=<span class="keyword">true</span>, </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                      <span class="keywordtype">bool</span> shared=<span class="keyword">false</span>, Arena* ar = <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// using IBFab</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keyword">explicit</span> <a class="code" href="classIBM_1_1IBFab.html">IBFab</a> (<span class="keyword">const</span> <a class="code" href="classIBM_1_1IBFab.html">IBFab</a>&amp; rhs, MakeType make_type, <span class="keywordtype">int</span> scomp, </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                      <span class="keywordtype">int</span> ncomp);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// IBFab (IBFab&amp;&amp; rhs) noexcept = default;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">// IBFab&amp; operator= (IBFab&amp;&amp;) noexcept = default;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">// IBFab (const IBM::IBFab&amp;) {};</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="comment">// IBFab&amp; operator= (const IBFab&amp;) = delete;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;     ~<a class="code" href="classIBM_1_1IBFab.html">IBFab</a> ();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// methods //</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span>  };</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// IBMultiFab holds an array of IBFab on a level</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classIBM_1_1IBMultiFab.html">  154</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classIBM_1_1IBMultiFab.html">IBMultiFab</a>: <span class="keyword">public</span> FabArray&lt;IBFab&gt; {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">// constructor from BoxArray and DistributionMapping</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keyword">explicit</span> <a class="code" href="classIBM_1_1IBMultiFab.html">IBMultiFab</a> ( <span class="keyword">const</span> BoxArray&amp; bxs, </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                            <span class="keyword">const</span> DistributionMapping&amp; dm, </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> nvar, </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> ngrow, </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                            <span class="keyword">const</span> MFInfo&amp; info = MFInfo(), </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                            <span class="keyword">const</span> FabFactory&lt;IBFab&gt;&amp; factory = DefaultFabFactory&lt;IBFab&gt;());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">// move constructor</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="classIBM_1_1IBMultiFab.html">IBMultiFab</a> (<a class="code" href="classIBM_1_1IBMultiFab.html">IBMultiFab</a>&amp;&amp; rhs) noexcept; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">// destructor</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      ~<a class="code" href="classIBM_1_1IBMultiFab.html">IBMultiFab</a> ();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keywordtype">void</span> copytoRealMF(MultiFab &amp;mf, <span class="keywordtype">int</span> ibcomp, <span class="keywordtype">int</span> mfcomp);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  };</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// IB is the main class. It holds an array of IBMultiFab, one for each AMR level; and it also holds the geometry</span></div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html">  176</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classIBM_1_1IB.html">IB</a> {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="comment">// attributes //</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a73be569d71c7dfad84a7cce2a0086586">  179</a></span>&#160;      Vector&lt;Real&gt; <a class="code" href="classIBM_1_1IB.html#a73be569d71c7dfad84a7cce2a0086586">disIM</a>; <span class="comment">//image point distance per level</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a1f9ecaba9a5162fbe3d22e68e5e67649">  181</a></span>&#160;      <span class="keywordtype">int</span> MAX_LEVEL = 0;   <span class="comment">// need to save this as Amr protects this -- set in ib.init(...)</span></div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a8e53bbbdda28918c0bd9e36d1a583188">  182</a></span>&#160;      <span class="keywordtype">int</span> NGHOST_IB = 0; <span class="comment">// number of ghost points in IBMultiFab -- set in ib.init(...)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a4c42acc282725731e0ede5c173a43b33">  183</a></span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> NVAR_IB  = 2; <span class="comment">// number of variables in IBMultiFab</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">// const int NIMPS = 2; // number of image points per ghost point</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="comment">// pointer to Amr class instance</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a3ba2ac24f1f7ecd63d34353d2fb2e999">  187</a></span>&#160;      Amr*<a class="code" href="classIBM_1_1IB.html#a3ba2ac24f1f7ecd63d34353d2fb2e999">pamr</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// vector of refinement ratio per level in each direction</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#adb32acf0ce453f0e54b666d3fcaad2e0">  190</a></span>&#160;      Vector&lt;IntVect&gt; <a class="code" href="classIBM_1_1IB.html#adb32acf0ce453f0e54b666d3fcaad2e0">ref_ratio</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// vector of cell sizes per level in each direction</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a7c9679ddd949b4945b05b22f92c3f506">  193</a></span>&#160;      Vector&lt;GpuArray&lt;Real,AMREX_SPACEDIM&gt;&gt; <a class="code" href="classIBM_1_1IB.html#a7c9679ddd949b4945b05b22f92c3f506">cellSizes</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="comment">// Immersed boundary MultiFab array</span></div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a8ff615e4167cbecef6daee586831df7a">  196</a></span>&#160;      Vector&lt;IBMultiFab*&gt; <a class="code" href="classIBM_1_1IB.html#a8ff615e4167cbecef6daee586831df7a">ibMFa</a>; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">// Level set MultiFab array</span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a85b4b2b8f08e3bbf0f43e121adbcb77a">  199</a></span>&#160;      Vector&lt;MultiFab&gt; <a class="code" href="classIBM_1_1IB.html#a85b4b2b8f08e3bbf0f43e121adbcb77a">lsMFa</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// IB explicit geometry</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#ae7f9f222de2e5fcdd5db0b17df39b63f">  202</a></span>&#160;      <a class="code" href="namespaceIBM.html#aef0e4eb6d237070846f13a40d2e90063">Polyhedron</a> <a class="code" href="classIBM_1_1IB.html#ae7f9f222de2e5fcdd5db0b17df39b63f">geom</a>;  </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="comment">// AABB tree</span></div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#afae998704e6da3b34fd1c59f4074e672">  205</a></span>&#160;      <a class="code" href="namespaceIBM.html#ad9f4d764f206d71381e965523b58ace3">Tree</a>* <a class="code" href="classIBM_1_1IB.html#afae998704e6da3b34fd1c59f4074e672">treePtr</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Instead of std::map you may use std::unordered_map, boost::unordered_map</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// or CGAL::Unique_hash_map</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// CGAL::Unique_hash_map&lt;face_descriptor,Vector&gt; fnormals;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// boost::unordered_map&lt;vertex_descriptor,Vector&gt; vnormals;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// face element normals</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#a471b16fe6a4073eb5463c2ac71846933">  213</a></span>&#160;      std::map&lt;face_descriptor,Vector_CGAL&gt; <a class="code" href="classIBM_1_1IB.html#a471b16fe6a4073eb5463c2ac71846933">fnormals</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">// face state data map</span></div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classIBM_1_1IB.html#af7344a130ff189614b58136411565c60">  215</a></span>&#160;      std::map&lt;face_descriptor,surfdata&gt; <a class="code" href="classIBM_1_1IB.html#af7344a130ff189614b58136411565c60">face2state</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">// std::map stores information in a binary tree, it has log(N) complexity for key-value pair insertion and value retrieval for a key.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">// could also fit normals into this -- however might need to modify compute_normals routine</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">// face displacement map</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="comment">// std::map&lt;face_descriptor,Vector_CGAL&gt; fdisplace;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="comment">// Vector or Real[3] don&#39;t work</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keyword">explicit</span> <a class="code" href="classIBM_1_1IB.html">IB</a> ();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      ~<a class="code" href="classIBM_1_1IB.html">IB</a> ();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">// methods //</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordtype">void</span> init (Amr* pointer_amr, <span class="keyword">const</span> <span class="keywordtype">int</span> nghost);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordtype">void</span> <span class="keyword">static</span> compute_plane_equations( Polyhedron::Facet&amp; f);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordtype">void</span> buildMFs (<span class="keyword">const</span> BoxArray&amp; bxa, <span class="keyword">const</span> DistributionMapping&amp; dm, <span class="keywordtype">int</span> lev);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordtype">void</span> destroyMFs (<span class="keywordtype">int</span> lev);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordtype">void</span> readGeom();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordtype">void</span> computeMarkers (<span class="keywordtype">int</span> lev);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordtype">void</span> initialiseGPs(<span class="keywordtype">int</span> lev);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordtype">void</span> computeGPs( <span class="keywordtype">int</span> lev, MultiFab&amp; consmf, MultiFab&amp; primsmf, <span class="keyword">const</span> PROB::ProbClosures&amp; closures);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordtype">void</span> moveGeom();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordtype">void</span> computeSurf(<span class="keywordtype">int</span> lev);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordtype">void</span> computeIPweights(Array2D&lt;Real,0,NIMPS-1,0,7&gt;&amp;weights, Array2D&lt;Real,0,NIMPS-1,0,AMREX_SPACEDIM-1&gt;&amp;imp_xyz, Array2D&lt;int,0,NIMPS-1,0,AMREX_SPACEDIM-1&gt;&amp; imp_ijk, GpuArray&lt;Real,AMREX_SPACEDIM&gt;&amp; dxyz, <span class="keyword">const</span> Array4&lt;bool&gt; markersFab, <span class="keyword">auto</span> <span class="keyword">const</span> idxCube);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">// AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">// void extrapolateGP(Array2D&lt;Real,0,NIMPS+1,0,NPRIM-1&gt;&amp; primStateNormal, Real dgp, Real dim);</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">// AMREX_GPU_HOST_DEVICE AMREX_FORCE_INLINE void ComputeGPState(long ii,const IBM::IBFab&amp; ibFab);</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  };</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// declare main IB class instance</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="namespaceIBM.html#a4caba61add10b22958723fae113c891a">  259</a></span>&#160;  <span class="keyword">inline</span> <a class="code" href="classIBM_1_1IB.html">IB</a> <a class="code" href="namespaceIBM.html#a4caba61add10b22958723fae113c891a">ib</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aIBM_8h_html_aa3bb3b5f8fcd8b028b753db498e5c2ef"><div class="ttname"><a href="IBM_8h.html#aa3bb3b5f8fcd8b028b753db498e5c2ef">NIMPS</a></div><div class="ttdeci">#define NIMPS</div><div class="ttdef"><b>Definition:</b> IBM.h:4</div></div>
<div class="ttc" id="aclassIBM_1_1IBFab_html"><div class="ttname"><a href="classIBM_1_1IBFab.html">IBM::IBFab</a></div><div class="ttdef"><b>Definition:</b> IBM.h:120</div></div>
<div class="ttc" id="aclassIBM_1_1IBFab_html_a7b39d2c2c612847501a75b9b39e8a0b8"><div class="ttname"><a href="classIBM_1_1IBFab.html#a7b39d2c2c612847501a75b9b39e8a0b8">IBM::IBFab::gpData</a></div><div class="ttdeci">gpData_t gpData</div><div class="ttdef"><b>Definition:</b> IBM.h:125</div></div>
<div class="ttc" id="aclassIBM_1_1IBMultiFab_html"><div class="ttname"><a href="classIBM_1_1IBMultiFab.html">IBM::IBMultiFab</a></div><div class="ttdef"><b>Definition:</b> IBM.h:154</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html"><div class="ttname"><a href="classIBM_1_1IB.html">IBM::IB</a></div><div class="ttdef"><b>Definition:</b> IBM.h:176</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_a3ba2ac24f1f7ecd63d34353d2fb2e999"><div class="ttname"><a href="classIBM_1_1IB.html#a3ba2ac24f1f7ecd63d34353d2fb2e999">IBM::IB::pamr</a></div><div class="ttdeci">Amr * pamr</div><div class="ttdef"><b>Definition:</b> IBM.h:187</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_a471b16fe6a4073eb5463c2ac71846933"><div class="ttname"><a href="classIBM_1_1IB.html#a471b16fe6a4073eb5463c2ac71846933">IBM::IB::fnormals</a></div><div class="ttdeci">std::map&lt; face_descriptor, Vector_CGAL &gt; fnormals</div><div class="ttdef"><b>Definition:</b> IBM.h:213</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_a73be569d71c7dfad84a7cce2a0086586"><div class="ttname"><a href="classIBM_1_1IB.html#a73be569d71c7dfad84a7cce2a0086586">IBM::IB::disIM</a></div><div class="ttdeci">Vector&lt; Real &gt; disIM</div><div class="ttdef"><b>Definition:</b> IBM.h:179</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_a7c9679ddd949b4945b05b22f92c3f506"><div class="ttname"><a href="classIBM_1_1IB.html#a7c9679ddd949b4945b05b22f92c3f506">IBM::IB::cellSizes</a></div><div class="ttdeci">Vector&lt; GpuArray&lt; Real, AMREX_SPACEDIM &gt; &gt; cellSizes</div><div class="ttdef"><b>Definition:</b> IBM.h:193</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_a85b4b2b8f08e3bbf0f43e121adbcb77a"><div class="ttname"><a href="classIBM_1_1IB.html#a85b4b2b8f08e3bbf0f43e121adbcb77a">IBM::IB::lsMFa</a></div><div class="ttdeci">Vector&lt; MultiFab &gt; lsMFa</div><div class="ttdef"><b>Definition:</b> IBM.h:199</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_a8ff615e4167cbecef6daee586831df7a"><div class="ttname"><a href="classIBM_1_1IB.html#a8ff615e4167cbecef6daee586831df7a">IBM::IB::ibMFa</a></div><div class="ttdeci">Vector&lt; IBMultiFab * &gt; ibMFa</div><div class="ttdef"><b>Definition:</b> IBM.h:196</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_adb32acf0ce453f0e54b666d3fcaad2e0"><div class="ttname"><a href="classIBM_1_1IB.html#adb32acf0ce453f0e54b666d3fcaad2e0">IBM::IB::ref_ratio</a></div><div class="ttdeci">Vector&lt; IntVect &gt; ref_ratio</div><div class="ttdef"><b>Definition:</b> IBM.h:190</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_ae7f9f222de2e5fcdd5db0b17df39b63f"><div class="ttname"><a href="classIBM_1_1IB.html#ae7f9f222de2e5fcdd5db0b17df39b63f">IBM::IB::geom</a></div><div class="ttdeci">Polyhedron geom</div><div class="ttdef"><b>Definition:</b> IBM.h:202</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_af7344a130ff189614b58136411565c60"><div class="ttname"><a href="classIBM_1_1IB.html#af7344a130ff189614b58136411565c60">IBM::IB::face2state</a></div><div class="ttdeci">std::map&lt; face_descriptor, surfdata &gt; face2state</div><div class="ttdef"><b>Definition:</b> IBM.h:215</div></div>
<div class="ttc" id="aclassIBM_1_1IB_html_afae998704e6da3b34fd1c59f4074e672"><div class="ttname"><a href="classIBM_1_1IB.html#afae998704e6da3b34fd1c59f4074e672">IBM::IB::treePtr</a></div><div class="ttdeci">Tree * treePtr</div><div class="ttdef"><b>Definition:</b> IBM.h:205</div></div>
<div class="ttc" id="anamespaceIBM_html"><div class="ttname"><a href="namespaceIBM.html">IBM</a></div><div class="ttdef"><b>Definition:</b> IBM.h:37</div></div>
<div class="ttc" id="anamespaceIBM_html_a26dbd197d9ba9813a5c7aeb26f2282da"><div class="ttname"><a href="namespaceIBM.html#a26dbd197d9ba9813a5c7aeb26f2282da">IBM::Traits</a></div><div class="ttdeci">CGAL::AABB_traits&lt; K2, Primitive &gt; Traits</div><div class="ttdef"><b>Definition:</b> IBM.h:47</div></div>
<div class="ttc" id="anamespaceIBM_html_a2ddefb5d5000c4bfda7bea2d34f5e6c3"><div class="ttname"><a href="namespaceIBM.html#a2ddefb5d5000c4bfda7bea2d34f5e6c3">IBM::FT</a></div><div class="ttdeci">K2::FT FT</div><div class="ttdef"><b>Definition:</b> IBM.h:44</div></div>
<div class="ttc" id="anamespaceIBM_html_a3bc0f9fb0e76244cb684d35d4cf0ac83"><div class="ttname"><a href="namespaceIBM.html#a3bc0f9fb0e76244cb684d35d4cf0ac83">IBM::Segment</a></div><div class="ttdeci">K2::Segment_3 Segment</div><div class="ttdef"><b>Definition:</b> IBM.h:45</div></div>
<div class="ttc" id="anamespaceIBM_html_a3ed74778d4b5bb4688ad8aa65f024af3"><div class="ttname"><a href="namespaceIBM.html#a3ed74778d4b5bb4688ad8aa65f024af3">IBM::Vector_CGAL</a></div><div class="ttdeci">K2::Vector_3 Vector_CGAL</div><div class="ttdef"><b>Definition:</b> IBM.h:51</div></div>
<div class="ttc" id="anamespaceIBM_html_a4caba61add10b22958723fae113c891a"><div class="ttname"><a href="namespaceIBM.html#a4caba61add10b22958723fae113c891a">IBM::ib</a></div><div class="ttdeci">IB ib</div><div class="ttdef"><b>Definition:</b> IBM.h:259</div></div>
<div class="ttc" id="anamespaceIBM_html_a5c173780993440fb7c53b55b9d617904"><div class="ttname"><a href="namespaceIBM.html#a5c173780993440fb7c53b55b9d617904">IBM::K2</a></div><div class="ttdeci">CGAL::Simple_cartesian&lt; Real &gt; K2</div><div class="ttdef"><b>Definition:</b> IBM.h:40</div></div>
<div class="ttc" id="anamespaceIBM_html_a7ae8422f8b42c8d6e43ac05822de0904"><div class="ttname"><a href="namespaceIBM.html#a7ae8422f8b42c8d6e43ac05822de0904">IBM::Point_and_primitive_id</a></div><div class="ttdeci">Tree::Point_and_primitive_id Point_and_primitive_id</div><div class="ttdef"><b>Definition:</b> IBM.h:49</div></div>
<div class="ttc" id="anamespaceIBM_html_ab004ecad26abd07304721f93b53c96d9"><div class="ttname"><a href="namespaceIBM.html#ab004ecad26abd07304721f93b53c96d9">IBM::Point</a></div><div class="ttdeci">K2::Point_3 Point</div><div class="ttdef"><b>Definition:</b> IBM.h:41</div></div>
<div class="ttc" id="anamespaceIBM_html_ad80af28e30018458d4c4c1efc0ba02d7"><div class="ttname"><a href="namespaceIBM.html#ad80af28e30018458d4c4c1efc0ba02d7">IBM::face_descriptor</a></div><div class="ttdeci">boost::graph_traits&lt; Polyhedron &gt;::face_descriptor face_descriptor</div><div class="ttdef"><b>Definition:</b> IBM.h:52</div></div>
<div class="ttc" id="anamespaceIBM_html_ad9f4d764f206d71381e965523b58ace3"><div class="ttname"><a href="namespaceIBM.html#ad9f4d764f206d71381e965523b58ace3">IBM::Tree</a></div><div class="ttdeci">CGAL::AABB_tree&lt; Traits &gt; Tree</div><div class="ttdef"><b>Definition:</b> IBM.h:48</div></div>
<div class="ttc" id="anamespaceIBM_html_aef0e4eb6d237070846f13a40d2e90063"><div class="ttname"><a href="namespaceIBM.html#aef0e4eb6d237070846f13a40d2e90063">IBM::Polyhedron</a></div><div class="ttdeci">CGAL::Polyhedron_3&lt; K2 &gt; Polyhedron</div><div class="ttdef"><b>Definition:</b> IBM.h:42</div></div>
<div class="ttc" id="anamespaceIBM_html_af12ba22129ce6cc0a035cbc8c914cab5"><div class="ttname"><a href="namespaceIBM.html#af12ba22129ce6cc0a035cbc8c914cab5">IBM::Primitive</a></div><div class="ttdeci">CGAL::AABB_face_graph_triangle_primitive&lt; Polyhedron &gt; Primitive</div><div class="ttdef"><b>Definition:</b> IBM.h:46</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html"><div class="ttname"><a href="structIBM_1_1gpData__t.html">IBM::gpData_t</a></div><div class="ttdef"><b>Definition:</b> IBM.h:78</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_a2dcf566c5d9c84b871125e70fade28aa"><div class="ttname"><a href="structIBM_1_1gpData__t.html#a2dcf566c5d9c84b871125e70fade28aa">IBM::gpData_t::gpData_t</a></div><div class="ttdeci">gpData_t()</div><div class="ttdef"><b>Definition:</b> IBM.h:80</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_a36cfbf4d4bd1c2369be07646b49cf80a"><div class="ttname"><a href="structIBM_1_1gpData__t.html#a36cfbf4d4bd1c2369be07646b49cf80a">IBM::gpData_t::ib_xyz</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Array1D&lt; Real, 0, AMREX_SPACEDIM-1 &gt; &gt; ib_xyz</div><div class="ttdef"><b>Definition:</b> IBM.h:98</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_a47dd83fc0c0bbfa7b887cbfda464d6a1"><div class="ttname"><a href="structIBM_1_1gpData__t.html#a47dd83fc0c0bbfa7b887cbfda464d6a1">IBM::gpData_t::imp_ijk</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Array2D&lt; int, 0, NIMPS-1, 0, AMREX_SPACEDIM-1 &gt; &gt; imp_ijk</div><div class="ttdef"><b>Definition:</b> IBM.h:102</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_a4ffba4d4b82e351308a38c852053a415"><div class="ttname"><a href="structIBM_1_1gpData__t.html#a4ffba4d4b82e351308a38c852053a415">IBM::gpData_t::ngps</a></div><div class="ttdeci">int ngps</div><div class="ttdef"><b>Definition:</b> IBM.h:93</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_a60be254d2dd72f7720c8d80683e456c4"><div class="ttname"><a href="structIBM_1_1gpData__t.html#a60be254d2dd72f7720c8d80683e456c4">IBM::gpData_t::resize</a></div><div class="ttdeci">void resize(int n)</div><div class="ttdef"><b>Definition:</b> IBM.h:111</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_a91e734453ba5a00bdc5d7ee769175bbb"><div class="ttname"><a href="structIBM_1_1gpData__t.html#a91e734453ba5a00bdc5d7ee769175bbb">IBM::gpData_t::imp_xyz</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Array2D&lt; Real, 0, NIMPS-1, 0, AMREX_SPACEDIM-1 &gt; &gt; imp_xyz</div><div class="ttdef"><b>Definition:</b> IBM.h:101</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_ab130b8cdca7247fb7c9e7710f61d6973"><div class="ttname"><a href="structIBM_1_1gpData__t.html#ab130b8cdca7247fb7c9e7710f61d6973">IBM::gpData_t::disGP</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Real &gt; disGP</div><div class="ttdef"><b>Definition:</b> IBM.h:99</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_ac2a1f182ea611fd539d30b0e37d49707"><div class="ttname"><a href="structIBM_1_1gpData__t.html#ac2a1f182ea611fd539d30b0e37d49707">IBM::gpData_t::gp_ijk</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Array1D&lt; int, 0, AMREX_SPACEDIM-1 &gt; &gt; gp_ijk</div><div class="ttdef"><b>Definition:</b> IBM.h:97</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_adef7a3cd3e3d61fad726f8ab600a814f"><div class="ttname"><a href="structIBM_1_1gpData__t.html#adef7a3cd3e3d61fad726f8ab600a814f">IBM::gpData_t::indexCube</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Array1D&lt; int, 0, AMREX_SPACEDIM-1 &gt; &gt; indexCube</div><div class="ttdef"><b>Definition:</b> IBM.h:108</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_af34569ede451cac3d84ddb1e1ca0584b"><div class="ttname"><a href="structIBM_1_1gpData__t.html#af34569ede451cac3d84ddb1e1ca0584b">IBM::gpData_t::closest_cgal</a></div><div class="ttdeci">Vector&lt; Point_and_primitive_id &gt; closest_cgal</div><div class="ttdef"><b>Definition:</b> IBM.h:94</div></div>
<div class="ttc" id="astructIBM_1_1gpData__t_html_afb4b7e71c94d2642ffeed1dfc726c735"><div class="ttname"><a href="structIBM_1_1gpData__t.html#afb4b7e71c94d2642ffeed1dfc726c735">IBM::gpData_t::imp_ipweights</a></div><div class="ttdeci">Gpu::ManagedVector&lt; Array2D&lt; Real, 0, NIMPS-1, 0, 7 &gt; &gt; imp_ipweights</div><div class="ttdef"><b>Definition:</b> IBM.h:103</div></div>
<div class="ttc" id="astructIBM_1_1surfdata_html"><div class="ttname"><a href="structIBM_1_1surfdata.html">IBM::surfdata</a></div><div class="ttdef"><b>Definition:</b> IBM.h:59</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
